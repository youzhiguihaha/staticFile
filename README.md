# åŸºäº Cloudflare Pages çš„è‡ªæ‰˜ç®¡æ–‡ä»¶ç³»ç»Ÿ

è¿™æ˜¯ä¸€ä¸ªåŸºäº React (Vite) å’Œ Cloudflare Pages Functions + R2 Storage æ„å»ºçš„æ— æœåŠ¡å™¨æ–‡ä»¶ç®¡ç†ç³»ç»Ÿã€‚

## åŠŸèƒ½ç‰¹ç‚¹
- ğŸ”’ **å®‰å…¨ç®¡ç†**: ä¸Šä¼ å’Œåˆ é™¤éœ€è¦å¯†ç éªŒè¯ã€‚
- â˜ï¸ **Cloudflare R2**: ä¾¿å®œ/å…è´¹çš„å¯¹è±¡å­˜å‚¨ã€‚
- âš¡ **Cloudflare Pages**: å¿«é€Ÿçš„å…¨çƒæ‰˜ç®¡ã€‚
- ğŸ”— **ç›´é“¾åˆ†äº«**: ç‚¹å‡»å³å¯å¤åˆ¶æ–‡ä»¶ç›´é“¾ï¼Œæ–¹ä¾¿å…¬å¼€åˆ†äº«ã€‚
- ğŸ“± **å“åº”å¼ç•Œé¢**: å®Œç¾æ”¯æŒç§»åŠ¨ç«¯å’Œæ¡Œé¢ç«¯ã€‚

## å‰ç½®æ¡ä»¶
1. ä¸€ä¸ª Cloudflare è´¦å·ã€‚
2. åœ¨ Cloudflare Dashboard ä¸­åˆ›å»ºä¸€ä¸ª R2 å­˜å‚¨æ¡¶ (Bucket)ã€‚

## éƒ¨ç½²æŒ‡å—

### ç¬¬ä¸€æ­¥ï¼šåˆ›å»º R2 å­˜å‚¨æ¡¶
1. è¿›å…¥ Cloudflare Dashboard > **R2**ã€‚
2. åˆ›å»ºä¸€ä¸ªæ–°çš„å­˜å‚¨æ¡¶ (ä¾‹å¦‚: `my-files`)ã€‚
3. **é‡è¦**: è¿›å…¥å­˜å‚¨æ¡¶è®¾ç½®ï¼Œ**å¼€å¯å…¬å¼€è®¿é—® (Public Access)** (é€šè¿‡è‡ªå®šä¹‰åŸŸåæˆ– R2.dev å­åŸŸå)ã€‚
   - è®°ä¸‹å…¬å¼€è®¿é—®åŸŸå (ä¾‹å¦‚: `https://pub-xxxxxxxx.r2.dev` æˆ– `https://files.yourdomain.com`)ã€‚

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²åˆ° Cloudflare Pages
1. ä½ å¯ä»¥ç›´æ¥å°†æ­¤ä»£ç åº“è¿æ¥åˆ° Cloudflare Pages è¿›è¡Œéƒ¨ç½²ã€‚
2. **æ„å»ºè®¾ç½® (Build Settings)**:
   - æ¡†æ¶ (Framework): `Vite`
   - æ„å»ºå‘½ä»¤ (Build command): `npm run build`
   - è¾“å‡ºç›®å½• (Output directory): `dist`

### ç¬¬ä¸‰æ­¥ï¼šé…ç½®ç¯å¢ƒå˜é‡ (å…³é”®)
åœ¨ä½ çš„ Cloudflare Pages é¡¹ç›®è®¾ç½®ä¸­ï¼Œè¿›å…¥ **Settings** > **Environment Variables** å¹¶æ·»åŠ ï¼š

| å˜é‡å | å€¼ | æè¿° |
| --- | --- | --- |
| `PASSWORD` | `your-secret-password` | ç”¨äºç™»å½•ç®¡ç†çš„ç®¡ç†å‘˜å¯†ç ã€‚ |
| `PUBLIC_DOMAIN` | `https://your-r2-domain.com` | ä½ çš„ R2 å­˜å‚¨æ¡¶å…¬å¼€é“¾æ¥ (ä¸è¦å¸¦æœ«å°¾çš„æ–œæ )ã€‚ |

### ç¬¬å››æ­¥ï¼šç»‘å®š R2 å­˜å‚¨æ¡¶
åœ¨ä½ çš„ Cloudflare Pages é¡¹ç›®è®¾ç½®ä¸­ï¼Œè¿›å…¥ **Settings** > **Functions** > **R2 Bucket Bindings**:

1. ç‚¹å‡» "Add binding"ã€‚
2. **Variable name**: `BUCKET` (å¿…é¡»å®Œå…¨ä¸€è‡´)ã€‚
3. **R2 Bucket**: é€‰æ‹©ä½ åœ¨ç¬¬ä¸€æ­¥åˆ›å»ºçš„å­˜å‚¨æ¡¶ã€‚

### ç¬¬äº”æ­¥ï¼šé‡æ–°éƒ¨ç½²
è¿›å…¥ **Deployments** å¹¶è§¦å‘ä¸€æ¬¡æ–°çš„éƒ¨ç½² (æˆ–è€…æäº¤æ–°çš„ä»£ç )ï¼Œä»¥ç¡®ä¿ç¯å¢ƒå˜é‡å’Œç»‘å®šç”Ÿæ•ˆã€‚

## æœ¬åœ°å¼€å‘
è¦åœ¨æœ¬åœ°è¿è¡Œï¼Œä½ éœ€è¦å®‰è£… `wrangler`ã€‚

```bash
npm install
npm run dev
```
*æ³¨æ„ï¼šæœ¬åœ°å¼€å‘éœ€è¦é€šè¿‡ wrangler pages dev è®¾ç½®æœ¬åœ° R2 ç»‘å®šï¼Œè¿™æ¯”è¾ƒå¤æ‚ã€‚å»ºè®®ç›´æ¥éƒ¨ç½²åˆ° Cloudflare Pages æµ‹è¯•åç«¯åŠŸèƒ½ã€‚*

## é¡¹ç›®ç»“æ„
- `src/`: React å‰ç«¯ä»£ç ã€‚
- `functions/`: Cloudflare Pages Functions (åç«¯ API)ã€‚
  - `functions/api/`: API ç«¯ç‚¹ã€‚
